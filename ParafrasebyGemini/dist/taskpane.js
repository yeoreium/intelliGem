/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={21915:function(e,t,n){"use strict";e.exports=n.p+"assets/intelliGem.png"},58394:function(e,t,n){"use strict";e.exports=n.p+"dba1fa9f27457863e6ba.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"677bbc2102dbdfe7b896.js"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){var n,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function s(e,a,o,i){var s=a&&a.prototype instanceof l?a:l,u=Object.create(s.prototype);return t(u,"_invoke",function(e,t,a){var o,i,s,l=0,u=a||[],d=!1,p={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return o=e,i=0,s=n,p.n=t,c}};function m(e,t){for(i=e,s=t,r=0;!d&&l&&!a&&r<u.length;r++){var a,o=u[r],m=p.p,f=o[2];e>3?(a=f===t)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=n):o[0]<=m&&((a=e<2&&m<o[1])?(i=0,p.v=t,p.n=o[1]):m<f&&(a=e<3||o[0]>t||t>f)&&(o[4]=e,o[5]=t,p.n=f,i=0))}if(a||e>1)return c;throw d=!0,t}return function(a,u,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,f),i=u,s=f;(r=i<2?n:s)||!d;){o||(i?i<3?(i>1&&(p.n=-1),m(i,s)):p.n=s:p.v=s);try{if(l=2,o){if(i||(a="next"),r=o[a]){if(!(r=r.call(o,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,i<2&&(i=0)}else 1===i&&(r=o.return)&&r.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=n}else if((r=(d=p.n<0)?s:e.call(t,p))!==c)break}catch(e){o=n,i=1,s=e}finally{l=1}}return{value:r,done:d}}}(e,o,i),!0),u}var c={};function l(){}function u(){}function d(){}r=Object.getPrototypeOf;var p=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),m=d.prototype=l.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,t(m,"constructor",d),t(d,"constructor",u),u.displayName="GeneratorFunction",t(d,i,"GeneratorFunction"),t(m),t(m,i,"Generator"),t(m,o,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:f}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){if(n)o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r;else{var i=function(n,r){t(e,n,function(e){return this._invoke(n,r,e)})};i("next",0),i("throw",1),i("return",2)}},t(e,n,r,a)}function n(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)})}}var a="welcome-page";function o(e){if(a!==e){var t=document.getElementById(a);t?(t.classList.add("fade-out"),setTimeout(function(){i(e),a=e},200)):(i(e),a=e)}}function i(e){var t=["welcome-page","main-page","settings-page","footer","header"],n=document.getElementById(t[3]),r=document.getElementById(t[4]);t.forEach(function(e){var t=document.getElementById(e);t&&(t.style.display="none",t.classList.remove("fade-in","fade-out"))});var a=document.getElementById(e);a&&(a.style.display="flex",a.classList.add("fade-in"),"main-page"===e&&(n.style.display="flex",r.style.display="flex",setTimeout(function(){var e=document.getElementById("textPromptInput");e&&e.focus()},300))),console.log("Navigated to: ".concat(e))}function s(){return c.apply(this,arguments)}function c(){return c=r(e().m(function t(){var n,a,o,i;return e().w(function(t){for(;;)switch(t.n){case 0:if(document.getElementById("chat-interface").style.opacity=100,n=document.getElementById("textPromptInput"),a=n.value.trim(),o=document.getElementById("ai-selector").value,v(),f(!0),a){t.n=1;break}return y("Mohon masukkan perintah atau pertanyaan Anda."),f(!1),t.a(2);case 1:return m("user",a),n.value="",h(),t.p=2,t.n=3,Word.run(function(){var t=r(e().m(function t(n){var r,i,s,c,u,d,p;return e().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.getSelection()).load("text"),r.load("inlinePictures"),e.n=1,n.sync();case 1:if(i=r.text.trim(),s=null,!(r.inlinePictures.items.length>0)){e.n=3;break}return(c=r.inlinePictures.items[0]).load("getBase64ImageSrc"),e.n=2,n.sync();case 2:(s=c.getBase64ImageSrc)&&(u=s.split(","),s=u.length>1?u[1]:null);case 3:return(d=n.document.body).load("text"),e.n=4,n.sync();case 4:return p=d.text.trim(),e.n=5,l(a,i,s,p,o);case 5:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:t.n=5;break;case 4:t.p=4,i=t.v,console.error("Kesalahan saat mengirim prompt ke Intelligem:",i),y("Terjadi kesalahan: ".concat(i.message,". Periksa console."));case 5:return t.p=5,b(),f(!1),t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])})),c.apply(this,arguments)}function l(e,t,n,r,a){return u.apply(this,arguments)}function u(){return(u=r(e().m(function t(n,r,a,o,i){var s,c,l,u,d;return e().w(function(e){for(;;)switch(e.n){case 0:return g("Intelligem sedang memproses... Harap tunggu."),e.p=1,s={userPrompt:n,selectedText:r,fullDocumentText:o,aiSelection:i},e.n=2,fetch("https://intelligem-production-10d1.up.railway.app/api/intelligem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 2:if(c=e.v,console.log("Response status dari backend Intelligem:",c.status),c.ok){e.n=4;break}return e.n=3,c.json().catch(function(){return{}});case 3:throw l=e.v,new Error("HTTP error! Status: ".concat(c.status," - ").concat(l.error||c.statusText||"Unknown error from backend"));case 4:return e.n=5,c.json();case 5:u=e.v,console.log("Data diterima dari backend Intelligem:",u),b(),u.explanation?m("ai",u.explanation,u.perlu_actionable,r,u.actionable_text):(y("Gagal mendapatkan respons AI yang valid dari Intelligem."),m("ai","Intelligem: Maaf, saya tidak bisa memproses permintaan Anda.")),g("Respons Intelligem diterima."),e.n=7;break;case 6:e.p=6,d=e.v,console.error("Kesalahan saat memanggil Intelligem API:",d),b(),y("Terjadi kesalahan: ".concat(d.message,".")),m("ai","Intelligem: Terjadi kesalahan. ".concat(d.message));case 7:return e.a(2)}},t,null,[[1,6]])}))).apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=r(e().m(function t(n,a){var o;return e().w(function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Word.run(function(){var t=r(e().m(function t(r){var o;return e().w(function(e){for(;;)switch(e.n){case 0:return o=r.document.getSelection(),"replace"===n?o.insertHtml(a,Word.InsertLocation.replace):"insert"===n&&o.insertText(a,Word.InsertLocation.after),e.n=1,r.sync();case 1:g("Teks berhasil disisipkan/diganti!");case 2:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error("Gagal menyisipkan/mengganti teks:",o),y("Gagal menyisipkan/mengganti: ".concat(o.message));case 3:return t.a(2)}},t,null,[[0,2]])})),p.apply(this,arguments)}function m(e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=document.getElementById("chatHistory"),o=document.createElement("div");if(o.classList.add("chat-message","".concat(e,"-message")),"ai"===e){var i=document.createElement("div");i.classList.add("message-header");var s=document.createElement("img");s.src="assets/intelliGem.png",s.classList.add("logo-message"),i.appendChild(s),o.appendChild(i);var c=document.createElement("p");if(c.innerHTML=marked.parse(t),o.appendChild(c),r){var l=document.createElement("div");l.classList.add("ai-actionable-text-box");var u=marked.parse(r);l.innerHTML=marked.parse(r),o.appendChild(l);var p=document.createElement("div");p.classList.add("ai-actions");var m=document.createElement("button");m.classList.add("ai-action-button"),m.innerHTML='<i class="fas fa-exchange-alt"></i> Ganti Teks Asli',m.onclick=function(){return d("replace",u)},p.appendChild(m);var f=document.createElement("button");f.classList.add("ai-action-button"),f.innerHTML='<i class="fas fa-plus"></i> Sisipkan Baru',f.onclick=function(){return d("insert",r)},p.appendChild(f),o.appendChild(p),o.dataset.actionableText=r,n&&(o.dataset.originalContextText=n)}}else o.innerText=t;a.appendChild(o),a.scrollTop=a.scrollHeight,textPromptInput.focus()}function f(e){document.getElementById("sendPromptButton").disabled=e,document.getElementById("textPromptInput").disabled=e}function g(e){var t=document.getElementById("statusMessage"),n=document.getElementById("errorMessage");t.querySelector(".status-text").innerText=e,t.style.display="flex",n.style.display="none"}function y(e){var t=document.getElementById("statusMessage"),n=document.getElementById("errorMessage");n.querySelector(".error-text").innerText=e,n.style.display="flex",t.style.display="none"}function v(){document.getElementById("statusMessage").style.display="none",document.getElementById("errorMessage").style.display="none",document.getElementById("statusMessage").querySelector(".status-text").innerText="",document.getElementById("errorMessage").querySelector(".error-text").innerText=""}function h(){var e=document.getElementById("chatHistory"),t=e.querySelector(".typing-indicator");t&&t.remove();var n=document.createElement("div");n.classList.add("ai-message","chat-message","typing-indicator"),n.style.maxWidth="80px";var r=document.createElement("div");r.classList.add("message-header"),n.appendChild(r);var a=document.createElement("div");a.style.display="flex",a.style.gap="4px",a.style.marginTop="8px";for(var o=0;o<3;o++){var i=document.createElement("div");i.classList.add("typing-dot"),a.appendChild(i)}n.appendChild(a),e.appendChild(n),e.scrollTop=e.scrollHeight}function b(){var e=document.querySelector(".typing-indicator");e&&e.remove()}Office.onReady(function(e){if(e.host===Office.HostType.Word){console.log("Office.js is ready. Host type:",e.host);var t=document.getElementById("sideload-msg");t&&(t.style.display="none"),i("welcome-page"),document.getElementById("startButton").onclick=function(){return o("main-page")},document.getElementById("settingsButton").onclick=function(){return o("settings-page")},document.getElementById("backToMainButton").onclick=function(){return o("main-page")},document.getElementById("sendPromptButton").onclick=s,document.getElementById("textPromptInput").addEventListener("keypress",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),s())}),console.log("UI terhubung.")}else console.log("Add-in tidak berjalan di Word.")})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(21915),n.b);new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map
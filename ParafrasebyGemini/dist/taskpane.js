/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"2feeb8de26aa9f2fb9fc.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"543bf44a73e08c96b148.js"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){var n,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function c(e,a,o,i){var c=a&&a.prototype instanceof u?a:u,l=Object.create(c.prototype);return t(l,"_invoke",function(e,t,a){var o,i,c,u=0,l=a||[],d=!1,p={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return o=e,i=0,c=n,p.n=t,s}};function m(e,t){for(i=e,c=t,r=0;!d&&u&&!a&&r<l.length;r++){var a,o=l[r],m=p.p,f=o[2];e>3?(a=f===t)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=n):o[0]<=m&&((a=e<2&&m<o[1])?(i=0,p.v=t,p.n=o[1]):m<f&&(a=e<3||o[0]>t||t>f)&&(o[4]=e,o[5]=t,p.n=f,i=0))}if(a||e>1)return s;throw d=!0,t}return function(a,l,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,f),i=l,c=f;(r=i<2?n:c)||!d;){o||(i?i<3?(i>1&&(p.n=-1),m(i,c)):p.n=c:p.v=c);try{if(u=2,o){if(i||(a="next"),r=o[a]){if(!(r=r.call(o,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,i<2&&(i=0)}else 1===i&&(r=o.return)&&r.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=n}else if((r=(d=p.n<0)?c:e.call(t,p))!==s)break}catch(e){o=n,i=1,c=e}finally{u=1}}return{value:r,done:d}}}(e,o,i),!0),l}var s={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var p=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),m=d.prototype=u.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=d,t(m,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,i,"GeneratorFunction"),t(m),t(m,i,"Generator"),t(m,o,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:f}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){if(n)o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r;else{var i=function(n,r){t(e,n,function(e){return this._invoke(n,r,e)})};i("next",0),i("throw",1),i("return",2)}},t(e,n,r,a)}function n(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(a,o){var i=e.apply(t,r);function c(e){n(i,a,o,c,s,"next",e)}function s(e){n(i,a,o,c,s,"throw",e)}c(void 0)})}}var a="welcome-page";function o(e){if(a!==e){var t=document.getElementById(a);t?(t.classList.add("fade-out"),setTimeout(function(){i(e),a=e},200)):(i(e),a=e)}}function i(e){["welcome-page","main-page","settings-page"].forEach(function(e){var t=document.getElementById(e);t&&(t.style.display="none",t.classList.remove("fade-in","fade-out"))});var t=document.getElementById(e);t&&(t.style.display="flex",t.classList.add("fade-in"),"main-page"===e&&setTimeout(function(){var e=document.getElementById("textPromptInput");e&&e.focus()},300)),console.log("Navigated to: ".concat(e))}function c(){return s.apply(this,arguments)}function s(){return s=r(e().m(function t(){var n,a,o;return e().w(function(t){for(;;)switch(t.n){case 0:if(n=document.getElementById("textPromptInput"),a=n.value.trim(),v(),g(!0),a){t.n=1;break}return h("Mohon masukkan perintah atau pertanyaan Anda."),g(!1),t.a(2);case 1:return m("user",a),n.value="",b(),t.p=2,t.n=3,Word.run(function(){var t=r(e().m(function t(n){var r,o,i,c,s,l,d;return e().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.getSelection()).load("text"),r.load("inlinePictures"),e.n=1,n.sync();case 1:if(o=r.text.trim(),i=null,!(r.inlinePictures.items.length>0)){e.n=3;break}return(c=r.inlinePictures.items[0]).load("getBase64ImageSrc"),e.n=2,n.sync();case 2:(i=c.getBase64ImageSrc)&&(s=i.split(","),i=s.length>1?s[1]:null);case 3:return(l=n.document.body).load("text"),e.n=4,n.sync();case 4:return d=l.text.trim(),e.n=5,u(a,o,i,d);case 5:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:t.n=5;break;case 4:t.p=4,o=t.v,console.error("Kesalahan saat mengirim prompt ke Intelligem:",o),h("Terjadi kesalahan: ".concat(o.message,". Periksa console."));case 5:return t.p=5,x(),g(!1),t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])})),s.apply(this,arguments)}function u(e,t,n,r){return l.apply(this,arguments)}function l(){return(l=r(e().m(function t(n,r,a,o){var i,c,s,u,l;return e().w(function(e){for(;;)switch(e.n){case 0:return y("Intelligem sedang memproses... Harap tunggu."),e.p=1,i={userPrompt:n,selectedText:r,fullDocumentText:o},a&&(i.imageData=a),e.n=2,fetch("http://localhost:3001/api/intelligem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});case 2:if(c=e.v,console.log("Response status dari backend Intelligem:",c.status),c.ok){e.n=4;break}return e.n=3,c.json().catch(function(){return{}});case 3:throw s=e.v,new Error("HTTP error! Status: ".concat(c.status," - ").concat(s.error||c.statusText||"Unknown error from backend"));case 4:return e.n=5,c.json();case 5:u=e.v,console.log("Data diterima dari backend Intelligem:",u),x(),u.explanation?m("ai",u.explanation,u.type,r,u.actionable_text):(h("Gagal mendapatkan respons AI yang valid dari Intelligem."),m("ai","Intelligem: Maaf, saya tidak bisa memproses permintaan Anda.")),y("Respons Intelligem diterima."),e.n=7;break;case 6:e.p=6,l=e.v,console.error("Kesalahan saat memanggil Intelligem API:",l),x(),h("Terjadi kesalahan: ".concat(l.message,".")),m("ai","Intelligem: Terjadi kesalahan. ".concat(l.message));case 7:return e.a(2)}},t,null,[[1,6]])}))).apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=r(e().m(function t(n,a){var o;return e().w(function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Word.run(function(){var t=r(e().m(function t(r){var o;return e().w(function(e){for(;;)switch(e.n){case 0:return o=r.document.getSelection(),"replace"===n?o.insertText(a,Word.InsertLocation.replace):"insert"===n&&o.insertText(a,Word.InsertLocation.after),e.n=1,r.sync();case 1:y("Teks berhasil disisipkan/diganti!");case 2:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error("Gagal menyisipkan/mengganti teks:",o),h("Gagal menyisipkan/mengganti: ".concat(o.message));case 3:return t.a(2)}},t,null,[[0,2]])})),p.apply(this,arguments)}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"general",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=document.getElementById("chatHistory"),i=document.createElement("div");if(i.classList.add("chat-message","".concat(e,"-message")),"ai"===e){var c=document.createElement("div");c.classList.add("message-header");var s=document.createElement("i");s.classList.add("fas","fa-robot","ai-icon");var u=document.createElement("span");u.classList.add("ai-name"),u.textContent="Intelligem",c.appendChild(s),c.appendChild(u),i.appendChild(c);var l=document.createElement("p");if(l.innerHTML=marked.parse(t),i.appendChild(l),a){var p=document.createElement("div");p.classList.add("ai-actionable-text-box"),p.innerText=a,i.appendChild(p);var g=document.createElement("div");g.classList.add("ai-actions");var y=document.createElement("button");y.classList.add("ai-action-button"),y.innerHTML='<i class="fas fa-exchange-alt"></i> Ganti Teks Asli',y.onclick=function(){return d("replace",a)},g.appendChild(y);var h=document.createElement("button");h.classList.add("ai-action-button"),h.innerHTML='<i class="fas fa-plus"></i> Sisipkan Baru',h.onclick=function(){return d("insert",a)},g.appendChild(h),i.appendChild(g),i.dataset.actionableText=a,r&&(i.dataset.originalContextText=r)}if(r&&("paraphrase"===n||"summarize"===n||"general_text"===n||"image_description"===n)){var v=i.querySelector(".ai-actions");v||((v=document.createElement("div")).classList.add("ai-actions"),i.appendChild(v));var b=document.createElement("button");b.classList.add("ai-action-button"),b.innerHTML='<i class="fas fa-search"></i> Cari Sumber Teks Ini',b.onclick=function(){return m("user",'Cari sumber untuk: "'.concat(r.substring(0,Math.min(r.length,50)),'..."')).then(function(){return function(e){return f.apply(this,arguments)}('Cari sumber untuk teks ini: "'.concat(r,'"'))})},v.appendChild(b)}}else i.innerText=t;o.appendChild(i),o.scrollTop=o.scrollHeight,textPromptInput.focus()}function f(){return(f=r(e().m(function t(n){return e().w(function(e){for(;;)switch(e.n){case 0:return document.getElementById("textPromptInput").value=n,e.n=1,c();case 1:return e.a(2)}},t)}))).apply(this,arguments)}function g(e){document.getElementById("sendPromptButton").disabled=e,document.getElementById("textPromptInput").disabled=e}function y(e){var t=document.getElementById("statusMessage"),n=document.getElementById("errorMessage");t.querySelector(".status-text").innerText=e,t.style.display="flex",n.style.display="none"}function h(e){var t=document.getElementById("statusMessage"),n=document.getElementById("errorMessage");n.querySelector(".error-text").innerText=e,n.style.display="flex",t.style.display="none"}function v(){document.getElementById("statusMessage").style.display="none",document.getElementById("errorMessage").style.display="none",document.getElementById("statusMessage").querySelector(".status-text").innerText="",document.getElementById("errorMessage").querySelector(".error-text").innerText=""}function b(){var e=document.getElementById("chatHistory"),t=e.querySelector(".typing-indicator");t&&t.remove();var n=document.createElement("div");n.classList.add("ai-message","chat-message","typing-indicator"),n.style.maxWidth="80px";var r=document.createElement("div");r.classList.add("message-header");var a=document.createElement("i");a.classList.add("fas","fa-robot","ai-icon");var o=document.createElement("span");o.classList.add("ai-name"),o.textContent="Intelligem",r.appendChild(a),r.appendChild(o),n.appendChild(r);var i=document.createElement("div");i.style.display="flex",i.style.gap="4px",i.style.marginTop="8px";for(var c=0;c<3;c++){var s=document.createElement("div");s.classList.add("typing-dot"),i.appendChild(s)}n.appendChild(i),e.appendChild(n),e.scrollTop=e.scrollHeight}function x(){var e=document.querySelector(".typing-indicator");e&&e.remove()}Office.onReady(function(e){if(e.host===Office.HostType.Word){console.log("Office.js is ready. Host type:",e.host);var t=document.getElementById("sideload-msg");t&&(t.style.display="none"),i("welcome-page"),document.getElementById("startButton").onclick=function(){return o("main-page")},document.getElementById("settingsButton").onclick=function(){return o("settings-page")},document.getElementById("backToMainButton").onclick=function(){return o("main-page")},document.getElementById("sendPromptButton").onclick=c,document.getElementById("textPromptInput").addEventListener("keypress",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),c())}),console.log("UI terhubung.")}else console.log("Add-in tidak berjalan di Word.")})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map